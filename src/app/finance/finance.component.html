<app-app-header></app-app-header>
<br>
<br>
<!-- Slider Area End -->

<div class="container mt-5">
  <div class="facture-container">
    <h2>Invoice List</h2>

    <!-- Bouton Ajouter -->
    <div class="button-container">
      <button ><a routerLink="/add-finance" >
       🧾Add
      </a></button>
    </div>

    <!-- Invoice List -->
    <table class="table">
      <thead>
        <tr>
       <!-- <th>Order ID</th>
          <th>Logistics Manager ID</th>   -->  
          <th>
            Total Amount
            <span (click)="sortByAmount('montantTotal')" style="cursor: pointer;">
              {{ sortDirection === 'asc' && sortField === 'montantTotal' ? '⬆️' : '⬇️' }}
            </span>
          </th>
          <th>Invoice Date</th>
          <th>Due Date</th>
          <th>
            Total Amount (Excl. Tax)
            <span (click)="sortByAmount('montantTotalHorsTaxe')" style="cursor: pointer;">
              {{ sortDirection === 'asc' && sortField === 'montantTotalHorsTaxe' ? '⬆️' : '⬇️' }}
            </span>
          </th>
          <th>Tax</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let facture of currentPageFactures">
        <!-- <td>{{ facture.idCommande }}</td>
          <td>{{ facture.idResponsableLogistique }}</td>   --> 
          <td>{{ facture.montantTotal | currency }}</td>
          <td>{{ facture.dateFacture | date }}</td>
         <!--  <td>{{ facture.dateEcheance | date }}</td> -->
         <td>
          {{ facture.dateEcheance | date: 'dd/MM/yyyy' }}
          <br>
          <span *ngIf="getDaysRemaining(facture.dateEcheance) >= 0">
            {{ getDaysRemaining(facture.dateEcheance) }} jours restants
          </span>
          <span *ngIf="getDaysRemaining(facture.dateEcheance) < 0">
            Échéance dépassée
          </span>
        </td>
          <td>{{ facture.montantTotalHorsTaxe | currency }}</td>
          <td>{{ facture.tva | currency }}</td>
          <td>
            <button [ngClass]="{'btn-success': facture.status === 'Paid', 'btn-danger': facture.status === 'Unpaid'}" (click)="toggleStatus(facture)">
              {{ facture.status === 'Paid' ? '✅ Paid' : '❌ Unpaid' }}
            </button>
          </td>
          <td>
            <div class="button-container">
              <button (click)="deleteFacture(facture.idFacture)">🗑️</button>
              <button (click)="updateFacture(facture)">✏️</button>
              <button (click)="navigateToPaiement(facture.idFacture)">💳</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

 <!-- Pagination -->
<nav>
  <ul class="pagination">
    <li class="page-item" [class.disabled]="currentPage === 1">
      <a class="page-link" (click)="changePage(currentPage - 1)" href="#">
        <i class="fas fa-chevron-left"></i> <!-- Flèche gauche -->
      </a>
    </li>
    <li *ngFor="let page of [].constructor(totalPages); let i = index" class="page-item" [class.active]="currentPage === i + 1">
      <a class="page-link" (click)="changePage(i + 1)" href="#">{{ i + 1 }}</a>
    </li>
    <li class="page-item" [class.disabled]="currentPage === totalPages">
      <a class="page-link" (click)="changePage(currentPage + 1)" href="#">
        <i class="fas fa-chevron-right"></i> <!-- Flèche droite -->
      </a>
    </li>
  </ul>
</nav>


  </div>
</div>

<app-app-footer></app-app-footer>
